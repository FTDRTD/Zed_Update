
# GUI字体修复补丁 - 手动应用到 updater/gui.py

# 1. 在setup_fonts()方法的第168-172行替换：
# 原来的代码:
if QFontDatabase().hasFamily(font_name):
    font.setFamily(font_name)
    break

# 修复后的代码:
try:
    # PyQt5的正确方法是families()
    available_fonts = QFontDatabase().families()
    if font_name in available_fonts:
        font.setFamily(font_name)
        break
except (AttributeError, TypeError):
    # 如果方法不兼容，使用退回策略
    try:
        font.setFamily(font_name)
        break
    except Exception:
        continue

# 2. 在create_log_tab()方法的第559-563行替换:
# 原来的代码:
if QFontDatabase().hasFamily(font_name):
    log_font.setFamily(font_name)
    break

# 修复后的代码:
try:
    # 使用PyQt5兼容的families()方法
    available_fonts = QFontDatabase.families()
    if font_name in available_fonts:
        log_font.setFamily(font_name)
        break
except (AttributeError, TypeError):
    # 如果方法不存在，使用默认策略
    try:
        log_font.setFamily(font_name)
        break
    except Exception:
        continue
